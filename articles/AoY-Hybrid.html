<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pf.memory">
<title>AoY Hybrid Model â€¢ pf.memory</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="AoY Hybrid Model">
<meta property="og:description" content="pf.memory">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pf.memory</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/FoI.html">FoI</a>
    <a class="dropdown-item" href="../articles/Dynamics.html">Dynamics</a>
    <a class="dropdown-item" href="../articles/AoY.html">AoY</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-hybrid-models">Hybrid Models</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-hybrid-models">
    <a class="dropdown-item" href="../articles/MoI.html">MoI - Hybrid</a>
    <a class="dropdown-item" href="../articles/prevalence.html">Prevalence</a>
    <a class="dropdown-item" href="../articles/AoI-Hybrid.html">AoI - Hybrid</a>
    <a class="dropdown-item" href="../articles/AoY-Hybrid.html">AoY - Hybrid</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-parasite">Parasite</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-parasite">
    <a class="dropdown-item" href="../articles/Simple_Infections.html">Simple Infections</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dd-harp/pf.memory/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>AoY Hybrid Model</h1>
            
      
      
      <div class="d-none name"><code>AoY-Hybrid.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dd-harp.github.io/pf.memory/">pf.memory</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://desolve.r-forge.r-project.org/" class="external-link">deSolve</a></span><span class="op">)</span></span></code></pre></div>
<p>Because of the utility of the AoY as a predictor of parasite
densities, we developed hybrid variables describing the change in the
mean AoY.</p>
<p><span class="math display">\[
\frac{\partial y}{\partial a} + \frac{\partial y}{\partial \alpha}= -
(F(r,m)+h) y,
\]</span></p>
<p>with the boundary condition <span class="math display">\[y_\tau(a,0)=h_\tau(a).\]</span></p>
<p>We write it in this form, in part, because we do not know how to
write the function <span class="math inline">\(F(r,m).\)</span> If we
assumed <span class="math inline">\(F(r,m) = r\)</span>, then we would
be assuming that <em>every</em> infection that cleared reset the AoY to
zero. If some individuals remained infected, however, the AoY would not
reset to zero. It would, instead, change to the age of the next
youngest.</p>
<p>In the next section, we derive an equation for <span class="math inline">\(dy/da,\)</span> and then we find a functional form
that works pretty well.</p>
<div class="section level2">
<h2 id="derivation-for-dyda">Derivation for <span class="math inline">\(dy/da\)</span><a class="anchor" aria-label="anchor" href="#derivation-for-dyda"></a>
</h2>
<p>We start by multiplying by <span class="math inline">\(\alpha\)</span> and integrating with respect to
<span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math display">\[
\int_0^a \alpha \frac{\partial y(\alpha, a)}{\partial a} d \alpha +
\int_0^a \alpha \frac{\partial y(\alpha, a)}{\partial \alpha} d\alpha =
- \left(F(r,m)  + h \right) \int_0^a \alpha y(\alpha, a) d\alpha
\]</span></p>
<p>but</p>
<p><span class="math display">\[\int_0^a \alpha y(\alpha, a) d\alpha
=  \left&lt;Y \right&gt; p\]</span></p>
<p>so</p>
<p><span class="math display">\[
\frac{d \left&lt; Y \right&gt; p}{da} + \int_0^a \alpha dy = - p
\left(F(r,m) + h \right) \left&lt; Y \right&gt;   
\]</span></p>
<p>Using the chain rule:</p>
<p><span class="math display">\[
\frac{\partial \left&lt;A \right&gt; p}{\partial a}=
p \frac{\partial \left&lt;A \right&gt;}{\partial a}  +
\left&lt;A \right&gt; \frac{\partial p}{\partial a}  
\]</span></p>
<p>and substituting:</p>
<p><span class="math display">\[
p \frac{d \left&lt; Y \right&gt;}{da} + \left&lt;Y \right&gt;
\frac{dp}{da}  + \int_0^a \alpha dy =
- p \left(F(r,m) + h \right) \left&lt;Y \right&gt;
\]</span></p>
<p>but <span class="math inline">\(dp/da = h(1-p) - R(m) p\)</span>
so</p>
<p><span class="math display">\[
p \frac{d \left&lt; Y \right&gt;}{da} = - \left[h (1-p) - R(m) p \right]
\left&lt;Y \right&gt;  
- p \left(F(r,m) + h \right) \left&lt;Y \right&gt;  - \int_0^a \alpha
dy  
\]</span></p>
<p>and now lots of things cancel, so:</p>
<p><span class="math display">\[
p \frac{d \left&lt; Y \right&gt;}{da} = - h \left&lt;Y \right&gt;
-(F(r,m)-R(m)) \left&lt;Y \right&gt; - \int_0^a \alpha dy  
\]</span></p>
<p>For the last term, we integrate by parts:</p>
<p><span class="math display">\[
\int_0^a \alpha \partial z =
\alpha y(a,\alpha) \big|_{\alpha = a} -
\alpha y(a,\alpha) \big|_{\alpha = 0} -
\int_0^a y d\alpha
\]</span></p>
<p>which simplifies to: (<strong>The first terms are wrong, I think is
wrong</strong>)</p>
<p><span class="math display">\[
\int_0^a \alpha \partial y =  a h_d(0)e^{-ra}
\]</span></p>
<p><span class="math display">\[
\frac{dy}{da} = 1 - \frac{h}{p} y  - \left( F(r,m) - R(m) \right) y
\]</span></p>
</div>
<div class="section level2">
<h2 id="frm">
<span class="math inline">\(F(r,m)\)</span><a class="anchor" aria-label="anchor" href="#frm"></a>
</h2>
<p>Our intuition was that the changes in the AoY could be worked out by
treating the MoI cases. We arrived at a function:</p>
<p><span class="math display">\[F(r, \zeta) = R(m) \left( 1 +
\frac{\zeta^{\sqrt{2}}}{4} + \sum_{k \geq 3} \frac{1}{k}
\frac{\zeta^3}{k!} \right). \]</span></p>
<p><span class="math display">\[F(r, \zeta) =
r \frac{\mbox{Pr}(\zeta=1; m(t))}{\mbox{Pr}(\zeta&gt;0; m(t))}
\left( 1 + \frac{\zeta^{\sqrt{2}}}{4} + \sum_{k \geq 3} \frac{1}{k}
\frac{\zeta^3}{k!} \right).
\]</span></p>
<p>Performance did not seem to improve by adding terms for <span class="math inline">\(k&gt;5.\)</span></p>
<ul>
<li><p><span class="math inline">\(\zeta=1\)</span> If MoI=1, then the
term should clear. This cancels out the other <span class="math inline">\(R(m)\)</span> term.</p></li>
<li><p>We reasoned that if the MoI were 2 or greater, then a change
would occur with probability <span class="math inline">\(1/\zeta\)</span>, <em>increasing</em> the AoY to
something close to <span class="math inline">\(y\)</span>.</p></li>
<li><p><span class="math inline">\(\zeta=2\)</span>: Somehow, we made a
mistake when we wrote down the first term, but we didnâ€™t notice until
much later. After fiddling around with the exponent, we found that <span class="math inline">\(\zeta^{\sqrt{2}}\)</span> worked better than <span class="math inline">\(\zeta\)</span> (where we started, by mistake), and
curiously, better than <span class="math inline">\(\zeta^2\)</span></p></li>
<li><p><span class="math inline">\(\zeta&gt;2\)</span>: These seemed to
work reasonably well.</p></li>
</ul>
<p>Ultimately, the justification for using this formula is that it seems
to work quite well.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by David L. Smith, John M. Henry.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
