<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="pf.memory">
<title>Parasite Infection Dynamics â€¢ pf.memory</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parasite Infection Dynamics">
<meta property="og:description" content="pf.memory">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">pf.memory</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/FoI.html">FoI</a>
    <a class="dropdown-item" href="../articles/Dynamics.html">Dynamics</a>
    <a class="dropdown-item" href="../articles/AoY.html">AoY</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-hybrid-models">Hybrid Models</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-hybrid-models">
    <a class="dropdown-item" href="../articles/MoI.html">MoI - Hybrid</a>
    <a class="dropdown-item" href="../articles/prevalence.html">Prevalence</a>
    <a class="dropdown-item" href="../articles/AoI-Hybrid.html">AoI - Hybrid</a>
    <a class="dropdown-item" href="../articles/AoY-Hybrid.html">AoY - Hybrid</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-parasite">Parasite</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-parasite">
    <a class="dropdown-item" href="../articles/Simple_Infections.html">Simple Infections</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dd-harp/pf.memory/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Parasite Infection Dynamics</h1>
            <h3 data-toc-skip class="subtitle">The Multiplicity and Age
of Infection</h3>
            
      
      
      <div class="d-none name"><code>Dynamics.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dd-harp.github.io/pf.memory/">pf.memory</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sjmgarnier.github.io/viridisLite/" class="external-link">viridisLite</a></span><span class="op">)</span></span></code></pre></div>
<p>In the following, we present functions to compute the distribution of
the multiplicity and age of infection.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Let <span class="math inline">\(z_\tau(\alpha,a)\)</span> denote the
density function for infections of age <span class="math inline">\(\alpha\)</span> in a host cohort of age <span class="math inline">\(a\)</span> born on day <span class="math inline">\(\tau\)</span>. The dynamics of <span class="math inline">\(z(\alpha,a)\)</span> in a population of humans are
described by the following:</p>
<p><span class="math display">\[
\frac{\partial z}{\partial a} + \frac{\partial z}{\partial \alpha} = - r
z
\]</span></p>
<p>with the boundary condition:</p>
<p><span class="math display">\[
    z_\tau(0,a) = h_\tau(a)
\]</span></p>
<p>We can solve the equation for any particular cohort exactly.
Solutions describe the density of infections of age <span class="math inline">\(\alpha\)</span> in a cohort (born on day <span class="math inline">\(\tau\)</span>) of age <span class="math inline">\(a\)</span>:</p>
<p><span class="math display">\[\begin{equation}
z_\tau(\alpha,a) = h_\tau(a-\alpha) e^{-r \alpha}
\tag{1}
\end{equation}\]</span></p>
<p>All solutions to <span class="math inline">\(z_\tau(\alpha,
a)\)</span> thus depend on a function that describes the history of
exposure, <span class="math inline">\(h_\tau(a)\)</span>, which we call
the force of infection (FoI).</p>
</div>
<div class="section level2">
<h2 id="force-of-infection-foi">Force of Infection (FoI)<a class="anchor" aria-label="anchor" href="#force-of-infection-foi"></a>
</h2>
<p>To compute anything, we must first set up a function to describe
exposure (see the <a href="FoI.html">FoI</a> vignette). We define
functions that plot the FoI for a cohort as it ages (in red), but we can
also compute the population average FoI (in black). Different cohorts
would experience different histories of exposure.</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-3-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="computing-zda">Computing <code>zda</code><a class="anchor" aria-label="anchor" href="#computing-zda"></a>
</h2>
<p>The function <code>pf.memory::zda(alpha, a, FoIpar, ...)</code> uses
the formula in Eq. 1 to compute the density of parasite infections in a
cohort of humans as it ages.</p>
<p>Using <code>zda,</code> we can compute the density of parasites in a
cohort of any age without solving a full system of equations. Given a
function describing the FoI in the population, <span class="math inline">\(h(t)\)</span>, and the cohort birthday, <span class="math inline">\(\tau.\)</span></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">=</span> <span class="fl">60</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fl">6</span><span class="op">*</span><span class="fl">365</span></span>
<span><span class="fu"><a href="../reference/zda.html">zda</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">6</span><span class="op">*</span><span class="fl">365</span>, <span class="va">foiP3</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.001601196</span></span></code></pre>
<p>The following computes the density of infections of every age in a
cohort of age 3.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zz</span> <span class="op">=</span> <span class="fu"><a href="../reference/zda.html">zda</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">a3years</span><span class="op">)</span>, <span class="va">foiP3</span><span class="op">)</span></span></code></pre></div>
<p>When we plot <span class="math inline">\(z_\tau(\alpha, a)\)</span>,
we note that as <span class="math inline">\(\alpha\)</span> grows
larger, the parasite cohort gets older. When we plot parasite cohorts by
age, time is going backwards on the x-axis.</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
<p>Now, we can imagine what <code>zda</code> would look like for several
different host cohorts at age three, but who were born at different
times. In effect, we are taking a snapshot of the cohorts at the same
age, but at different times.</p>
<p>The curves are different because the hosts were born at different
months, and they thus experienced different levels of exposure over the
first two years of life. Here the annual FoI is 5 infections, per
person, per year (<span class="math inline">\(\bar h =
5/365\)</span>):</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="multiplicity-of-infection-moi">Multiplicity of Infection (MoI)<a class="anchor" aria-label="anchor" href="#multiplicity-of-infection-moi"></a>
</h2>
<p>We define a random variable <span class="math inline">\(M\)</span>
describing the multiplicity of infection (MoI). The distribution of the
MoI is Poisson (see the <a href="MoI.html">MoI</a> vignette).</p>
<p><span class="math display">\[M_\tau(a) \sim f_M(\zeta; a, \tau) =
\mbox{Pois}(m_\tau(a))\]</span></p>
<p>Since <span class="math inline">\(z_\tau(\alpha, a)\)</span>
describes the density of <em>all</em> infections of age <span class="math inline">\(\alpha\)</span> in a cohort of age <span class="math inline">\(a\)</span>, the density of all infections must be
the MoI. Since <span class="math inline">\(0 \leq \alpha &lt;
a\)</span>, it must be true that:</p>
<p><span class="math display">\[\begin{equation}
\tag{2}
m_\tau(a) = \int_0^a z_\tau(\alpha, a) d \alpha
\end{equation}\]</span></p>
<p>The function that computes <span class="math inline">\(m_\tau(a)\)</span> is called
<code>meanMoI.</code></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mm</span> <span class="op">=</span> <span class="fu"><a href="../reference/meanMoI.html">meanMoI</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="va">foiP3</span>, hhat<span class="op">=</span><span class="fl">5</span><span class="op">/</span><span class="fl">365</span><span class="op">)</span></span></code></pre></div>
<p>Here, we plot the average MoI in the host cohort as it ages:</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="age-of-infection-aoi">Age of Infection (AoI)<a class="anchor" aria-label="anchor" href="#age-of-infection-aoi"></a>
</h2>
<p>We define a random variable <span class="math inline">\(A_\tau(a)\)</span> that describes the age of
infection (AoI), which is given by the formula</p>
<p><span class="math display">\[
A_\tau(a) \sim f_A(\alpha; a, \tau) = \frac{z_\tau(\alpha,a)}{m_\tau(a)}
\]</span></p>
<div class="section level3">
<h3 id="the-density-function-daoi">The Density Function, <code>dAoI</code><a class="anchor" aria-label="anchor" href="#the-density-function-daoi"></a>
</h3>
<p>We can compute <span class="math inline">\(A_\tau(a)\)</span> using
the density function <code>dAoI</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">f_A</span> <span class="op">=</span> <span class="fu"><a href="../reference/dAoI.html">dAoI</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">a3years</span><span class="op">)</span>, <span class="va">foiP3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<p>Now, as we plot the distribution of the AoI in cohorts at age two,
born at different months (as we did above), we notice that the
distributions have changed shapes:</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="the-distribution-function-paoi">The Distribution Function, <code>pAoI</code><a class="anchor" aria-label="anchor" href="#the-distribution-function-paoi"></a>
</h3>
<p>The distribution function for <span class="math inline">\(A_\tau(a)\)</span> is:</p>
<p><span class="math display">\[
F_A(a) \sim \int_0^\alpha f_A(\alpha; a, \tau) d\alpha
\]</span></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">F_A</span> <span class="op">=</span> <span class="fu"><a href="../reference/pAoI.html">pAoI</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">a3years</span><span class="op">)</span>, <span class="va">foiP3</span><span class="op">)</span></span></code></pre></div>
<p>If our functions work correctly, then we should get approximately the
same answer from computing the cumulative sum of <code>dAoI.</code></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">F_A_alt</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">f_A</span><span class="op">)</span></span></code></pre></div>
<p>We shouldnâ€™t expect the answers to be exactly the same, but they
should be close, with the <code>pAoI</code> in black.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="va">F_A</span>, type <span class="op">=</span> <span class="st">"l"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Parasite Cohort Age"</span>, </span>
<span>     ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="cn">F</span><span class="op">[</span><span class="va">X</span><span class="op">]</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">a</span>, <span class="va">tau</span><span class="op">)</span><span class="op">)</span>, lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="va">F_A_alt</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd<span class="op">=</span><span class="fl">2</span>, lty <span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-14-1.png" width="576"></p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-15-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="random-numbers-raoi">Random Numbers, <code>rAoI</code><a class="anchor" aria-label="anchor" href="#random-numbers-raoi"></a>
</h3>
<p>The function <code>rAoI</code> uses <code>pAoI</code> to generate
random numbers from <span class="math inline">\(F_A(\alpha)\)</span></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rhx</span> <span class="op">=</span> <span class="fu"><a href="../reference/rAoI.html">rAoI</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">3</span><span class="op">*</span><span class="fl">365</span>, <span class="va">foiP3</span><span class="op">)</span></span></code></pre></div>
<p>A simple visual check computes the empirical CDF for the random
variates against <span class="math inline">\(F_A(\alpha)\)</span>
computed using <code>pAoI</code></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">rhx</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1095</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">0.2</span>, main <span class="op">=</span> <span class="st">""</span>, </span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Parasite Age (in Days)"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>     ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">F</span><span class="op">[</span><span class="va">A</span><span class="op">]</span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"ecdf"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">a3years</span>, <span class="va">F_A</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-17-1.png" width="576"></p>
<p>We can also plot the distribution functions.</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-18-1.png" width="576"></p>
</div>
<div class="section level3">
<h3 id="moments-of-a_taua">Moments of <span class="math inline">\(A_\tau(a)\)</span><a class="anchor" aria-label="anchor" href="#moments-of-a_taua"></a>
</h3>
<p>Let <span class="math inline">\(x\)</span> denote the first moment of
of <span class="math inline">\(A_\tau(a)\)</span>: <span class="math display">\[x_\tau(a) = \left&lt; A_\tau(a) \right&gt; =
\int_0^\infty \alpha \frac{z_\tau(\alpha, a)} {m_\tau(a)}\]</span></p>
<p>Similarly, we let <span class="math inline">\(x_\tau(a)[n]\)</span>
denote the higher order moments of <span class="math inline">\(A_\tau(a)\)</span>: <span class="math display">\[x_{[n]}(a, \tau) = \int_0^\infty \alpha^n
\frac{z_\tau(\alpha, a)} {m_\tau(a)}\]</span></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a3years0</span> <span class="op">=</span> <span class="va">a3years</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">moment1</span> <span class="op">=</span> <span class="fu"><a href="../reference/momentAoI.html">momentAoI</a></span><span class="op">(</span><span class="va">a3years0</span>, <span class="va">foiP3</span><span class="op">)</span></span>
<span><span class="va">moment2</span> <span class="op">=</span> <span class="fu"><a href="../reference/momentAoI.html">momentAoI</a></span><span class="op">(</span><span class="va">a3years0</span>, <span class="va">foiP3</span>, n<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">moment3</span> <span class="op">=</span> <span class="fu"><a href="../reference/momentAoI.html">momentAoI</a></span><span class="op">(</span><span class="va">a3years0</span>, <span class="va">foiP3</span>, n<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p>The first three moments of the AoY plotted over time. In the top
plot, weâ€™ve also plotted the <span class="math inline">\(n^{th}\)</span>
root of the <span class="math inline">\(n^{th}\)</span> moment.</p>
<p><img src="Dynamics_files/figure-html/unnamed-chunk-20-1.png" width="576"></p>
<hr>
<p><strong>Next:</strong></p>
<ul>
<li>In the vignette <a href="MoI.html">Multiplicity of Infection: Hybrid
Models, Queuing Models, and Verification</a>, we show that the mean MoI
computed using the formula in Eq. 2 gives the same answer as other
approaches.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by David L. Smith, John M. Henry.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
